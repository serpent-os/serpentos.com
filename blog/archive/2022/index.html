
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://serpentos.com/blog/archive/2022/">
      
      
        <link rel="prev" href="../2023/">
      
      
        <link rel="next" href="../2021/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../static/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>2022 - Serpent OS</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#2022" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Serpent OS" class="md-header__button md-logo" aria-label="Serpent OS" data-md-component="logo">
      
  <img src="../../../static/logo_white.webp" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Serpent OS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              2022
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="light-blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../download/" class="md-tabs__link">
        
  
    
  
  Download

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../privacy/" class="md-tabs__link">
        
  
    
  
  Privacy

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Serpent OS" class="md-nav__button md-logo" aria-label="Serpent OS" data-md-component="logo">
      
  <img src="../../../static/logo_white.webp" alt="logo">

    </a>
    Serpent OS
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../privacy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Privacy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" checked>
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
      
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    2022
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../2020/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2020
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Categories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../category/news/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    news
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content" data-md-component="content">
    <div class="md-content__inner">
      <header class="md-typeset">
        <h1 id="2022">2022</h1>
      </header>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/53261402" alt="Ikey Doherty">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2022-12-24 01:32:04+00:00">Saturday, December 24, 2022</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/news/" class="md-meta__link">news</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="lift-off"><a class="toclink" href="../../2022/12/24/lift-off/">Lift Off</a></h2>
<p>Enough of this "2 years" nonsense. We're finally ready for lift off. It is with <em>immense pleasure</em> we can
finally announce that Serpent OS has transitioned from a promise to a deliverable. Bye bye, phantomware!</p>
<h4 id="we-exist"><a class="toclink" href="../../2022/12/24/lift-off/#we-exist">We exist</a></h4>
<p>As mentioned, we spent 2 years working on tooling and process. That's .. well. Kinda dull, honestly. You're
not here for the tooling, you're here for the OS. To that end I made a decision to accelerate development of
the actual <em>Linux distro</em> - and shift development of tooling into a parallel effort.</p>
<h4 id="infrastructure-intelligently-deferred"><a class="toclink" href="../../2022/12/24/lift-off/#infrastructure-intelligently-deferred">Infrastructure .. intelligently deferred</a></h4>
<p>I deferred final enabling of the infrastructure until January to rectify the chicken/egg scenario whilst allowing
us to grow a base of contributors and an actual distro to work with. We're in a good position with minimal blockers
so no concern there.</p>
<h4 id="a-real-software-collection"><a class="toclink" href="../../2022/12/24/lift-off/#a-real-software-collection">A real software collection</a></h4>
<p>This is our term for the classical "package repository". We're using a temporary collection right now to store all
of the builds we produce. In keeping with the <code>Avalanche</code> requirements, this is the <strong>volatile</strong> software collection. Changes
a lot, hasn't got a release policy.</p>
<h4 id="a-community"><a class="toclink" href="../../2022/12/24/lift-off/#a-community">A community.</a></h4>
<p>It goes without saying, really, that our project isn't remotely possible without a <strong>community</strong>. I want to take the time
to personally thank everyone that stepped up to the plate lately and contributed to Serpent OS. Without the work of the
team, in which I include the contributors to our <code>venom</code> recipe repository, an ISO was never possible. Additionally contributions
to tooling has helped us make significant strides.</p>
<p>It should be noted we've practically folded our old "team" concept and ensured we operate across the board as a singular community,
with some members having additional responsibilities. Our belief is all in the community have equal share and say. With that said,
to the original "team", members both past and present, I thank for their (long) support and contributions to the project.</p>
<h4 id="an-iso"><a class="toclink" href="../../2022/12/24/lift-off/#an-iso">An ISO.</a></h4>
<p>We actually went ahead and created our first ISO. OK that's a lie, this is probably the 20th revision by now. And let's be brutally
honest here:</p>
<p><strong>It sucks.</strong></p>
<p>We expected no less. However, the time is definitely here for us to begin our public iteration, transitioning from suckness to a project
worth using. In order to do that, we need to get ourselves to a point whereby we can dogfood our work and build a daily driver. Our focus
right now is building out the core technology and packaging to achieve those aims.</p>
<p>So if you want to try our uninstallable, buggy ISO, chiefly created as a brief introduction to our package manager and toolchain, head to our
newly minted <a href="/download">Download</a> page. Set your expectations low, ignore your dreams, and you will not be disappointed!</p>
<p>All jokes aside, it took a long time to get to point where we could even construct our first, KVM-focused, UEFI-only <code>snekvalidator.iso</code>. We now
have a baseline to improve on, a working contribution process, and a booting, self-hosting system.</p>
<p>The ISO is built using 2 layered collections, the <code>protosnek</code> collection containing our toolchain, and the new <code>volatile</code> collection. Much of the
packaging work has been submitted by <code>venom</code> contributors and the core team. Note you can install <code>neofetch</code> which our very own Rune Morling (<code>ermo</code>)
patched to support the Serpent OS logo.</p>
<p>Boot it in Qemu (or certain Intel laptops) and play with moss now! Note, this ISO is not installable, and no upgrade path exists. It is simply
the beginnings of a public iteration process.</p>
<h4 id="next-steps"><a class="toclink" href="../../2022/12/24/lift-off/#next-steps">Next steps</a></h4>
<p>In January we'll launch our infrastructure to scale out contributions as well as to permit the mass-rebuilds that need to happen. We have to
enable our <code>-dbginfo</code> packages and stripping, which were disabled due to a parallelism issue. We need to introduce our boot management based around
<code>systemd-boot</code>, provide more kernels, do hardware enabling, introduce <code>moss-triggers</code>, and much more. However, this is a <strong>pivotal moment</strong> for our
project as we've finally become a <strong>real</strong>, if not <strong>sucky</strong>, distro. The future is incredibly bright, and we intend to deliver on every one of our
promises.</p>
<p>As always, if you want to support our development, please consider <a href="/sponsors">sponsoring</a> the work, or engaging with the community on Matrix or indeed
our <a href="https://forums.serpentos.com">forums</a>. </p>
<p>You can discuss this blog post, or leave feedback on the ISO, over at our <a href="https://forums.serpentos.com/d/40-lift-off">forums</a>.</p>
    <nav class="md-post__action">
      <a href="../../2022/12/24/lift-off/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/53261402" alt="Ikey Doherty">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2022-09-14 12:55:04+01:00">Wednesday, September 14, 2022</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/news/" class="md-meta__link">news</a></li>
        
        
          
          <li class="md-meta__item">
            
              5 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="the-big-update"><a class="toclink" href="../../2022/09/14/the-big-update/">The Big Update</a></h2>
<p>Well - we've got some big news! The past few weeks have been an incredibly busy
time for us, and we've hit some major milestones.</p>
<!--more-->

<h2 id="funding"><a class="toclink" href="../../2022/09/14/the-big-update/#funding">Funding</a></h2>
<p>After much deliberation - we've decided to pull out of Open Collective. Among other reasons, the fees
are simply too high and severely impact the funds available to us. In our early stages, the team consensus
is that funds generated are used to compensate my time working on Serpent OS.</p>
<p>As such I'm now moving funding to my own <a href="https://github.com/sponsors/ikeycode?o=sd&amp;sc=t">GitHub Sponsors</a> page - please do migrate! It ensures your entire
donation makes it and keeps the lights on for longer =) Please remember I'm working <strong>full time</strong> on Serpent OS
exclusively - I need your help to keep working.</p>
<h2 id="moved-to-github"><a class="toclink" href="../../2022/09/14/the-big-update/#moved-to-github">Moved to GitHub</a></h2>
<p>We've pretty much completed our transition to GitHub. We've now got the following organisations:</p>
<ul>
<li><a href="https://github.com/snekpit">snekpit</a> - Packaging work</li>
<li><a href="https://github.com/serpent-os">serpent-os</a> - Main code development (moss/boulder/etc)</li>
</ul>
<h2 id="forums"><a class="toclink" href="../../2022/09/14/the-big-update/#forums">Forums</a></h2>
<p>Don't forget - our forums are <strong>live</strong> over at <a href="https://forums.serpentos.com">forums.serpentos.com</a> - please feel
free to drop in and join in with the community =)</p>
<h2 id="rehash-on-the-tooling"><a class="toclink" href="../../2022/09/14/the-big-update/#rehash-on-the-tooling">Rehash on the tooling</a></h2>
<p>OK so what exactly <em>are</em> <code>moss</code> and <code>boulder</code>? In short - they're the absolute core pieces of our distribution model.</p>
<h3 id="what-is-moss"><a class="toclink" href="../../2022/09/14/the-big-update/#what-is-moss">"What is moss?"</a></h3>
<p>On the surface, moss looks and feels roughly the same as just about any other traditional package manager out there.
Internally, however, its far more modern and has a few tricks up its sleeve. For instance, every time you initiate
an operation in moss, be it installation, removal, upgrade, etc, a new filesystem transaction is generated. In short,
if something is wrong with the new transaction - you can just boot to an older transaction when things worked fine.</p>
<p>Now, it's not implemented using bundles or filesystem specific functionality, internally its just intelligent use of
hardlinks and deduplication policies, and we have our own container format with zstd based payload compression. Our
strongly typed, deduplicating binary format is what powers moss.</p>
<p>Behind the scenes we also use some other cool technology, such as LMDB for super reliable and speedy database access.
The net result is a next generation package management solution that offers all the benefits of traditional package
managers (i.e. granularity and composition) with new world features, like atomic updates, deduplication, and repository
snapshots.</p>
<h3 id="boulder"><a class="toclink" href="../../2022/09/14/the-big-update/#boulder">boulder</a></h3>
<p>It's one thing to manage and install packages, it's another entirely to <strong>build them</strong>. <code>boulder</code> builds conceptually
on prior art such as <code>pisi</code> and the <code>package.yml</code> format used in <code>ypkg</code>. It is designed with automation
and ease of integration in mind, i.e. less time spent focusing on <strong>packaging</strong> and more time on actually
getting the thing building and installing correctly.</p>
<p>Boulder supports "macros" as seen in the RPM and ypkg world, to support consistent builds and integration.
Additionally it automatically splits up packages into the appropriate subpackages, and automatically scans
for binary, pkgconfig, perl and other dependencies during source analysis and build time. The end result
is some <code>.stone</code> binary packages and a build manifest, which we use to flesh out our <strong>source package index</strong>.</p>
<h2 id="major-moss-improvements"><a class="toclink" href="../../2022/09/14/the-big-update/#major-moss-improvements">Major moss improvements</a></h2>
<p>We've spent considerable time reworking <code>moss</code>, our package manager. It now features
a fresher (terminal) user interface, progress bars, and is rewritten to use the
<a href="https://github.com/serpent-os/moss-db">moss-db</a> module encapsulating LMDB.</p>
<p><img alt="nspawn" src="/static/img/blog/the-big-update/nspawn.webp" /></p>
<p>It's also possible to manipulate the binary collections (software repositories)
used by moss now. Note we're going to rename "remote" to "collection" for consistency.</p>
<p>At the time of writing:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$<span class="w"> </span>mkdir<span class="w"> </span>destdir
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>$<span class="w"> </span>sudo<span class="w"> </span>moss<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>-D<span class="w"> </span>destdir<span class="w"> </span>protosnek<span class="w"> </span>https://dev.serpentos.com/protosnek/x86_64/stone.index
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>$<span class="w"> </span>sudo<span class="w"> </span>moss<span class="w"> </span>install<span class="w"> </span>-D<span class="w"> </span>destdir<span class="w"> </span>bash<span class="w"> </span>dash<span class="w"> </span>dbus<span class="w"> </span>dbus-broker<span class="w"> </span>systemd<span class="w"> </span>coreutils<span class="w"> </span>util-linux<span class="w"> </span>which<span class="w"> </span>moss<span class="w"> </span>nano
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>$<span class="w"> </span>sudo<span class="w"> </span>systemd-nspawn<span class="w"> </span>-b<span class="w"> </span>-D<span class="w"> </span>destdir
</span></code></pre></div>
<p>This will be simplified once we introduce <code>virtual</code> packages (Coming Soon &trade;)</p>
<h2 id="local-collections"><a class="toclink" href="../../2022/09/14/the-big-update/#local-collections">Local Collections</a></h2>
<p>Boulder can now be instructed to utilise a local collection of stone packages, simplifying the development of large stack items.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo<span class="w"> </span>boulder<span class="w"> </span>bi<span class="w"> </span>stone.yml<span class="w"> </span>-p<span class="w"> </span>local-x86_64
</span></code></pre></div>
<p>Packages should be moved to <code>/var/cache/boulder/collections/local-x86_64</code> and the index
can be updated by running:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>sudo<span class="w"> </span>moss<span class="w"> </span>idx<span class="w"> </span>/var/cache/boulder/collections/local-x86_64
</span></code></pre></div>
<h2 id="self-hosting"><a class="toclink" href="../../2022/09/14/the-big-update/#self-hosting">Self Hosting</a></h2>
<p>Serpent OS is now officially self hosting. Using our own packages, we're able to
construct a root filesystem, then within that rootfs container we can use our own
build tooling (<code>boulder</code>) to construct <strong>new builds</strong> of our packages in a nested
container.</p>
<p>The <code>protosnek</code> collection has been updated to include the newest versions of moss
and boulder.</p>
<p><img alt="self hosting" src="/static/img/blog/the-big-update/self-hosting.webp" /></p>
<h2 id="booting"><a class="toclink" href="../../2022/09/14/the-big-update/#booting">Booting</a></h2>
<p>As a fun experiment, we wanted to see how far along things are. Using a throwaway
kernel + initrd build, we were able to get Serpent OS booting using virtualisation (<code>qemu</code>)</p>
<p><img alt="booting" src="/static/img/blog/the-big-update/booting.webp" /></p>
<h2 id="iso-when"><a class="toclink" href="../../2022/09/14/the-big-update/#iso-when">ISO When?</a></h2>
<p>Right now everyone is working in the <a href="https://github.com/snekpit">snekpit</a> organisation to
get our base packaging in order. I'm looking to freeze <code>protosnek</code>, our bootstrap collection,
at the latest of tomorrow evening.</p>
<p>We now support layered, priority based collections (repositories) and dependency solving across
collection boundaries, allowing us to build our new <code>main</code> collection with <code>protosnek</code> acting as
a bootstrap seed.</p>
<p>Throughout this week, I'll focus on getting Avalanche, Summit and Vessel into shape for PoC so
that we can enjoy automated builds of packages landing in the yet-to-be-launched <code>volatile</code> collection.</p>
<p>From there, we're going to iterate + improve packaging, fixing bugs and landing features as we
discover the issues. Initially we'll look to integrate <strong>triggers</strong> in a stateless-friendly
fashion (our packages can only ship <code>/usr</code> by design) - after that will come boot management.</p>
<p>An early target will be Qemu support via a stripped <code>linux-kvm</code> package to accelerate the bring up,
and we encourage everyone to join in the testing. We're self hosting, we know how to boot, and
now we're able to bring the awesome.</p>
<p>I cannot stress how important the support to the project is. Without it - I'm unable to work full
time on the project. Please consider supporting my development work via <a href="https://github.com/sponsors/ikeycode?o=sd&amp;sc=t">GitHub Sponsors</a>.</p>
<blockquote>
<p>I'm so broke they've started naming black holes after my IBAN.</p>
</blockquote>
<p>Thank you!</p>
<p>You can discuss this blog post over on <a href="https://forums.serpentos.com/d/20-the-big-update">our forums</a></p>
    <nav class="md-post__action">
      <a href="../../2022/09/14/the-big-update/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/53261402" alt="Ikey Doherty">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2022-07-10 11:26:05+01:00">Sunday, July 10, 2022</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/news/" class="md-meta__link">news</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="infrastructure-update"><a class="toclink" href="../../2022/07/10/infrastructure-update/">Infrastructure Update</a></h2>
<p>Since the last post, I've pivoted to full time work on Serpent OS, which is
made all the more possible thanks to everyone supporting us via <a href="https://opencollective.com/serpent-os">OpenCollective</a> &lt;3.</p>
<p>We've been working towards establishing an online infrastructure to support the automation of package <strong>builds</strong>, while
revisiting some core components.</p>
<!--more-->

<h2 id="moss-db"><a class="toclink" href="../../2022/07/10/infrastructure-update/#moss-db">moss-db</a></h2>
<p>During the development of the Serpent OS tooling we've been exploring the possibilities of D Lang, picking up new
practices and refining our approach as we go. Naturally, some of our older modules are somewhat ... <em>smelly</em>.
Most noticeable is our <code>moss-db</code> module, which was initially intended as a lightweight wrapper around <a href="http://rocksdb.org/">RocksDB</a>.</p>
<p>In practice that required an encapsulation API written in D around the C API, and our own wrapping on top of that. Naturally,
it resulted in a very allocation-heavy implementation that just didn't sit right with us, and due to the absurd complexity
of RocksDB was still missing quite a few features.</p>
<h3 id="enter-lmdb"><a class="toclink" href="../../2022/07/10/infrastructure-update/#enter-lmdb">Enter LMDB</a></h3>
<p>We're now using the <a href="https://www.symas.com/lmdb">Lightning Memory-Mapped Database</a> as the driver implementation
for moss-db. In short, we get rapid reads, ACID transactions, bulk inserts, you name it. Our implementation takes
advantage of multiple database indexes (<code>MDB_dbi</code>) in LMDB to partition the database into internal components,
so that we can provide "buckets", or collections. These internal DBs are used for bucket mapping to permit a
key-compaction strategy - iteration of top level buckets and key-value pairs within a bucket.</p>
<h3 id="hat-tip-boltdb"><a class="toclink" href="../../2022/07/10/infrastructure-update/#hat-tip-boltdb">Hat tip, boltdb</a></h3>
<p>The majority of the API was designed with the <a href="https://github.com/boltdb/bolt">boltdb</a> API in mind. Additionally
it was built with <code>-preview=dip1000</code> and <code>-preview=in</code> enabled, ensuring safely scoped memory use and no
room for memory lifetime issues. While we prefer the use of generics, the API is built with <code>immutable(ubyte[]</code>)
as the internal key and value type.</p>
<p>Custom types can simply implement <code>mossEncode</code> or <code>mossDecode</code> to be instantly serialisable into the database
as keys, values or bucket identifiers.</p>
<p>Example API usage:</p>
<div class="language-d highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">Database</span><span class="w"> </span><span class="n">db</span><span class="p">;</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="cm">/* setup the DB with lmdb:// URI */</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="cm">/* Write transaction */</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">auto</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">update</span><span class="p">((</span><span class="k">scope</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="nd">@safe</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">{</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">bucket</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tx</span><span class="p">.</span><span class="n">bucket</span><span class="p">(</span><span class="s">&quot;letters&quot;</span><span class="p">);</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">tx</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">bucket</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="p">});</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="cm">/* do something with the error */</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">err</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">db</span><span class="p">.</span><span class="n">view</span><span class="p">((</span><span class="k">in</span><span class="w"> </span><span class="n">tx</span><span class="p">)</span><span class="w"> </span><span class="nd">@safe</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="p">{</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">bucket</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">tx</span><span class="p">.</span><span class="n">buckets</span><span class="p">!</span><span class="kt">int</span><span class="p">)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">        </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">tx</span><span class="p">.</span><span class="n">iterator</span><span class="p">!(</span><span class="nb">string</span><span class="p">,</span><span class="nb">string</span><span class="p">)(</span><span class="n">bucket</span><span class="p">))</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">        </span><span class="p">{</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">            </span><span class="cm">/* do something with the key value pairs, decoded as strings */</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="w">    </span><span class="cm">/* WILL NOT COMPILE. tx is const scope ref :) */</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">    </span><span class="n">tx</span><span class="p">.</span><span class="n">removeBucket</span><span class="p">(</span><span class="s">&quot;numbers&quot;</span><span class="p">);</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">NoDatabaseError</span><span class="p">;</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="next-for-moss"><a class="toclink" href="../../2022/07/10/infrastructure-update/#next-for-moss">Next for moss</a></h3>
<p>Moss will be ported to the new DB API and we'll gather some performance metrics,
while implementing features like expired state garbage collection (disk cleanup),
searching for names/descriptions, etc.</p>
<h2 id="avalanche"><a class="toclink" href="../../2022/07/10/infrastructure-update/#avalanche">Avalanche</a></h2>
<p><img alt="Early version of avalanche, in development" src="../../../static/img/blog/infrastructure-update/Featured.webp" /></p>
<p>Avalanche is a core component of our upcoming infrastructure, providing the
service for running builds on a local node, and a controller to coordinate
a group of builders.</p>
<p>Summit will be the publicly accessible project dashboard, and will be responsible
for coordinating incoming builds to Avalanche controllers and repositories.
Developers will submit builds to Summit and have them dispatched correctly.</p>
<p>So far we have the core service process in place for the Controller + Node,
and now we're working on persistence and handshake. TLDR; fancy use of
moss-db and JSON Web tokens over mandated SSL. This means our build infra
will be scalable from day 1 allowing multiple builders to be online very
early on.</p>
<h2 id="timescale"><a class="toclink" href="../../2022/07/10/infrastructure-update/#timescale">Timescale</a></h2>
<p>We're planning to get an early version of our infrastructure up and running
within the next 2 weeks, and get builds flowing =)</p>
    <nav class="md-post__action">
      <a href="../../2022/07/10/infrastructure-update/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/53261402" alt="Ikey Doherty">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2022-06-22 17:23:14+01:00">Wednesday, June 22, 2022</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/news/" class="md-meta__link">news</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="packaging-automation-next-steps"><a class="toclink" href="../../2022/06/22/packaging-automation-next-steps/">Packaging Automation, Next Steps</a></h2>
<p>Hot damn we've been busy lately. No, <a href="https://gitlab.com/groups/serpent-os/-/activity">really</a>.
The latest development cycle saw us focus exclusively on <code>boulder</code>, our build tooling. As of
today it features a proof of concept <code>boulder new</code> subcommand for the automatic generation of
packaging templates from an upstream source (i.e. tarball).</p>
<!--more-->

<p>Before we really start this blog post off, I'd like to thank everyone who is supporting the
project! All of the <a href="https://opencollective.com/serpent-os">OpenCollective</a> contributions will make it easier for me to work full
time on Serpent OS =) Much love &lt;3</p>
<p><img alt="Look at all the buildiness" src="../../../static/img/blog/packaging-automation-next-steps/Featured.webp" /></p>
<h2 id="but-but-build-flavours"><a class="toclink" href="../../2022/06/22/packaging-automation-next-steps/#but-but-build-flavours">But, but build <em>flavours</em> ...</a></h2>
<p>Alright you got me there, certain projects prefer to abstract the configuration, build and
installation of packages and be provided with some kind of hint to the build system, i.e.
manually setting <code>autotools</code>, etc.</p>
<p>Serpent OS packaging is declarative and well structured, and relies on the use of RPM-style
"macros" for distribution integration and common tasks to ensure consistent packaging.</p>
<p>We prefer a self documenting approach that can be machine validated rather than depending
on introspection at the time of build. Our <code>stone.yml</code> format is very flexible and powerful,
with automatic runtime dependencies and package splitting as standard.</p>
<p>..Doesn't mean we can't make packaging <strong>even easier</strong> though.</p>
<h2 id="build-discovery"><a class="toclink" href="../../2022/06/22/packaging-automation-next-steps/#build-discovery">Build discovery</a></h2>
<p>Pointing boulder at an upstream source will perform a deep analysis of the sources to determine
the build system type, build dependencies, metadata, licensing etc. Right now it's just getting
ready to leave POC stage so it has a few warts, however it does have support for generating
package skeletons for the following build systems:</p>
<ul>
<li><code>cmake</code></li>
<li><code>meson</code></li>
<li><code>autotools</code></li>
</ul>
<p>We're adding automation for Perl and Python packaging (and Golang, Rust, etc) so we can enforce consistency,
integration and ease without being a burden on developers. This will greatly reduce the friction
of contribution - allowing anyone to package for Serpent OS.</p>
<p>We're also able to automatically discover build time dependencies during analysis and add those
to the skeleton <code>stone.yml</code> file. We'll enhance support for other build systems as we go, ensuring
that each new package is as close to done on creation as possible, with review and iteration left
to the developer.</p>
<h2 id="license-compliance"><a class="toclink" href="../../2022/06/22/packaging-automation-next-steps/#license-compliance">License compliance</a></h2>
<p>A common pain in the arse when packaging for <em>any</em> Linux distribution is ensuring the package
information is <em>compliant</em> in terms of licensing. As such we must know all of the licensing
information, as well as FSF and OSI compliance for our continuous integration testing.</p>
<p>...Finding all of that information is truly a painful process when conducted manually.
Thankfully <code>boulder</code> can perform analysis of all licensing files within the project to
greatly improve compliance and packaging.</p>
<p>Every license listed in a <code>stone.yml</code> file must use a valid <a href="https://spdx.dev/">SPDX</a> identifier,
and be accurate. boulder now scans all license files, looking for matches with both SPDX IDs
as well as fuzzy-matching the text of input licenses to make a best-guess at the license ID.</p>
<p>This has so far been highly accurate and correctly identifies many hundreds of licenses,
ensuring a compliant packaging process with less pain for the developers. Over time we'll
optimise and improve this process to ensure compliance <em>for</em> our developers rather than
blocking them.</p>
<p>As of today we support the <a href="https://reuse.software/">REUSE</a> specification for expressing software licenses too!</p>
<h2 id="next-on-the-list"><a class="toclink" href="../../2022/06/22/packaging-automation-next-steps/#next-on-the-list">Next on the list</a></h2>
<p>The next steps are honest-to-goodness exciting for us. Or should I say.. exiting?</p>
<h3 id="bill"><a class="toclink" href="../../2022/06/22/packaging-automation-next-steps/#bill">bill</a></h3>
<p>Work formally begins now on Bootstrap Bill (Turner). Whilst we did successfully bootstrap Serpent OS
and construct the <code>Protosnek</code> repository, the process for that is <strong>not</strong> reproducible as <code>boulder</code>
has gone through massive changes in this time.</p>
<p>The new <a href="https://gitlab.com/serpent-os/core/bill">project</a> will leverage <code>boulder</code> and a newly
designed bootstrap process to eliminate all host contamination and bootstrap Serpent OS from
<code>stone.yml</code> files, emitting an <em>immutable</em> bootstrap repository.</p>
<p>Layering support will land in <code>moss</code> and <code>boulder</code> to begin the infrastructure projects.</p>
<h3 id="build-submission-lets-roll"><a class="toclink" href="../../2022/06/22/packaging-automation-next-steps/#build-submission-lets-roll">Build Submission ("Let's Roll")</a></h3>
<p>The aim is to complete <code>bill</code> in a very short time so we can bring some initial infrastructure
online to facilitate the automatic build of submitted build jobs. We'll use this process
to create our live repository, replacing the initial bootstrap repository from bill.</p>
<p>At this point all of the tooling we have will come together to allow us all to very
quickly iterate on packaging, polish up <code>moss</code> and race towards installed systems with
online updates.</p>
    <nav class="md-post__action">
      <a href="../../2022/06/22/packaging-automation-next-steps/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/53261402" alt="Ikey Doherty">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2022-06-06 20:36:51+01:00">Monday, June 6, 2022</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/news/" class="md-meta__link">news</a></li>
        
        
          
          <li class="md-meta__item">
            
              1 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="a-word-from-the-founder"><a class="toclink" href="../../2022/06/06/a-word-from-the-founder/">A Word From The Founder</a></h2>
<p>Well well, it's been a long time since I personally wrote a post.. :) So let's keep
this short and sweet, shall we? I'm returning to full time work on Serpent OS.</p>
<!--more-->

<p>The 6th of July will be my last day at my current employment having tendered my
30 day notice today. Despite having enjoyment at my current position, the reality
is that my passion and focus is Serpent OS.</p>
<p>I'm now in a transition process and will ramp up my efforts with Serpent OS.
Realistically I need to reduce the outgoing costs of the project and with
your help I can gain some level of financial support as we move through the
next stages of development. Worst case, I will only take on any part-time or
contractual gigs, allowing my primary focus to be Serpent OS.</p>
<p>I'll begin accelerating works and enabling community contribution so we can
get the derailed-alpha train back on the tracks.</p>
<p>I have absolute faith in this project, the community and our shared ability
to deliver the OS and tooling. To achieve it will require far more of my time
and I'm perfectly willing to give it.</p>
<p>Thank you all to everyone who has been supporting the project, it is now
time to deliver. Not just another run of the mill distribution but a technically
competent and usable distribution that is not only different but <em>better</em>.</p>
<p>Let's do this in the most grassroots and enjoyable way possible =)</p>
    <nav class="md-post__action">
      <a href="../../2022/06/06/a-word-from-the-founder/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/19542864" alt="Peter O'Connor">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2022-04-05 11:12:54+10:00">Tuesday, April 5, 2022</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/news/" class="md-meta__link">news</a></li>
        
        
          
          <li class="md-meta__item">
            
              6 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="relr-brings-smaller-files-more-performance"><a class="toclink" href="../../2022/04/05/relr-brings-smaller-files-more-performance/">RELR Brings Smaller Files, More Performance?</a></h2>
<p><code>RELR</code> is an efficient method of storing relative relocations (but is not yet available in <code>glibc</code> upstream). This has a
significant reduction on file size often in the vicinity of 5% for libraries and even higher for PIE binaries. We also
take a look at the performance impact on enabling <code>RELR</code> and that looks really good too! Smaller files with more
performance - you <strong>can</strong> have your cake and eat it too!</p>
<!--more-->

<h2 id="delicious-size-savings"><a class="toclink" href="../../2022/04/05/relr-brings-smaller-files-more-performance/#delicious-size-savings">Delicious Size Savings</a></h2>
<p>Everyone enjoys smaller files, especially when it's for free! <code>RELR</code> provides a very efficient method of storing
relative relocations where it only requires a few percent compared to storing them in the <code>.rela.dyn</code> section which is
what currently happens. However, it can't store everything so the <code>.rela.dyn</code> section remains (though much smaller).</p>
<p>Here's an example of the sections of <code>libLLVM-13.so</code> with and without <code>RELR</code>. Here we see the <code>.rela.dyn</code> section taking
up a whole 2MB! When enabling <code>RELR</code>, <code>.rela.dyn</code> shrinks down to just under 100KB while adding a new section
<code>.relr.dyn</code> which is just over 20KB! That's nearly a 1.9MB file size reduction, so you'll get smaller packages, smaller
updates and it will be even faster to create delta packages from our servers. For reference, some of the biggest files
have a <code>.rela.dyn</code> section over 10MB!</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Section</th>
<th>Without RELR</th>
<th>With RELR</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">.dynstr</td>
<td>2,285,738</td>
<td>2,285,723</td>
</tr>
<tr>
<td style="text-align: center;">.rela.dyn</td>
<td>2,006,472</td>
<td>97,464</td>
</tr>
<tr>
<td style="text-align: center;">.relr.dyn</td>
<td>-</td>
<td>21,688</td>
</tr>
<tr>
<td style="text-align: center;">.text</td>
<td>28,708,290</td>
<td>28,708,386</td>
</tr>
<tr>
<td style="text-align: center;">.dynamic</td>
<td>592</td>
<td>608</td>
</tr>
<tr>
<td style="text-align: center;"></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align: center;">Total</td>
<td>44,853,987</td>
<td>42,966,764</td>
</tr>
</tbody>
</table>
<h2 id="smaller-but-at-what-cost"><a class="toclink" href="../../2022/04/05/relr-brings-smaller-files-more-performance/#smaller-but-at-what-cost">Smaller, But at What Cost?</a></h2>
<p>While most of the discussion about <code>RELR</code> is around the size savings, there's been very little in terms of the
performance numbers of enabling <code>RELR</code>. For most things, it's not going to make a noticeable difference, as it should
only really impact loading of binaries. There's one rule we have and that's to measure everything! We care about every
little detail where many 1-2% improvements can add up to significant gains.</p>
<p>First, we require a test to determine if we could detect changes between an <code>LLVM</code> built with <code>RELR</code> and one without.
The speed of the compiler is vital to a distro, where lackluster performance of the build system hurts all contributors
and anyone performing source based builds. <code>clang</code> in this example was built using a shared <code>libLLVM</code> so that it would
load the <code>RELR</code> section and it's large enough to be able to measure a difference in load times (if one exists). Building
<code>gettext</code> was the chosen test (total time includes tarball extraction, configure, make and make install stages), rather
than a synthetic binary loading test to reflect real world usage. The configure stage is very long when building
<code>gettext</code> so <code>clang</code> is called many times for short compiles. Lets take a look at the results:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>no RELR:
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>[Build] Finished: 1 minute, 57 secs, 80 ms, 741 s, and 2 hnsecs
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>[Build] Finished: 1 minute, 57 secs, 691 ms, 586 s, and 4 hnsecs
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>[Build] Finished: 1 minute, 56 secs, 861 ms, 31 s, and 8 hnsecs
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>RELR:
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>[Build] Finished: 1 minute, 55 secs, 244 ms, 213 s, and 8 hnsecs
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>[Build] Finished: 1 minute, 55 secs, 400 ms, 158 s, and 8 hnsecs
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>[Build] Finished: 1 minute, 55 secs, 775 ms, 40 s, and 8 hnsecs
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>RELR+startup patch:
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>[Build] Finished: 1 minute, 54 secs, 979 ms, 166 s, and 8 hnsecs
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>[Build] Finished: 1 minute, 54 secs, 820 ms, and 675 s
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>[Build] Finished: 1 minute, 54 secs, 713 ms, 440 s, and 3 hnsecs
</span></code></pre></div>
<p>Here we see the base configuration was able to build <code>gettext</code> in 117.21s on average. When we enabled <code>RELR</code> in our
<code>LLVM</code> build (all other packages were without <code>RELR</code> still), the average build time decreased by 1.74s! That does not
sound like a lot, but the time spent loading <code>clang</code> would only be a portion of the total, yet still gives a 1-2%
performance lift over the whole build. While we were reducing start up time, I ran another test, but this time adding a
patch to reduce paths searched on startup as well as enabling <code>RELR</code>. This patch reduced the average build time by a
further 0.63s!</p>
<p>That's a 2.37s reduction in the build just from improving the <code>clang</code> binary's load time.</p>
<h2 id="what-this-means-relr-by-default"><a class="toclink" href="../../2022/04/05/relr-brings-smaller-files-more-performance/#what-this-means-relr-by-default">What This Means - RELR by Default</a></h2>
<p>So what actually is <code>RELR</code>? I can't really do the topic justice, so will point you to a great blog post about RELR,
<a href="https://maskray.me/blog/2021-10-31-relative-relocations-and-relr">Relative Relocations and RELR</a>. It's quite technical
for the average reader, but definitely worth a read if you like getting into the details. To no surprise the author
(Fangrui Song) started the initial push for getting <code>RELR</code> support upstream in <code>glibc</code> (at the time of this post the
patch series has not yet been committed to <code>glibc</code> git).</p>
<p>What I can tell you, is that we've applied the requisite patches for <code>RELR</code> support and enabled <code>RELR</code> by default in
<code>boulder</code> for builds. Our container has been rebuilt and all is working well with <code>RELR</code> enabled. More measurements will
be done in future in the same controlled manner, particularly around PIE load times.</p>
<h2 id="caveats-the-hidden-details"><a class="toclink" href="../../2022/04/05/relr-brings-smaller-files-more-performance/#caveats-the-hidden-details">Caveats - The Hidden Details</a></h2>
<p>The performance benchmark was quite limited in terms of being an optimal case for <code>RELR</code> as <code>clang</code> is called thousands
of times in the build so on average improved load time by about 0.6-0.7ms. We can presume that using <code>RELR</code> on smaller
files is unlikely to regress load times. It definitely gives us confidence that it would be about the same or better in
most situations, but not noticeable or measurable in most use cases. Minimizing build times is a pretty significant
target for us, so even these small gains are appreciated.</p>
<p>The size savings can vary between packages and not everything can be converted into the <code>.relr.dyn</code> section. The current
default use of <code>RELR</code> is not without cost as it adds a version dependency on <code>glibc</code>. We will ensure we ship a sane
implementation that minimizes or removes such overhead.</p>
<p>It was also not straight forward to utilize <code>RELR</code> in Serpent. The pending upstream <code>glibc</code>
<a href="https://sourceware.org/pipermail/libc-alpha/2022-February/136290.html">patch series</a> included a patch which caused
issues when enabling <code>RELR</code> in Serpent OS (patch 3/5). As we utilize two toolchains, <code>gcc/bfd</code> and <code>clang/lld</code>, both
need to function independently to create outputs of a functional OS. However the part "Issue an error if there is a
DT_RELR entry without GLIBC_ABI_DT_RELR dependency nor GLIBC_PRIVATE definition." meant that <code>glibc</code> would <strong>refuse to
load files linked by <code>lld</code> despite having the ability to load them</strong>. <code>lld</code> has supported <code>RELR</code> for some time already,
but does not create the <code>GLIBC_ABI_DT_RELR</code> dependency that is required by <code>glibc</code>. I have added my
<a href="https://sourceware.org/pipermail/libc-alpha/2022-March/136773.html">feedback</a> to the patch set upstream. <code>lld</code> now has
support for this version dependency upstream if we ever decide to use it in future.</p>
<p>After dropping the patch and patching <code>bfd</code> to no longer generate the <code>GLIBC_ABI_DT_RELR</code> dependency either, I was
finally able to build both <code>glibc</code> and <code>LLVM</code> with the same patches. With overcoming that hurdle, rebuilding the rest of
the repository went without a hitch, so we are now enjoying <code>RELR</code> in all of our builds and is enabled by default.</p>
<p>There is even further scope for more size savings, by switching the <code>rela.dyn</code> section for the <code>rel.dyn</code> section (this
is what is used for 32-bit builds and one of the reasons files are smaller!). <code>lld</code> supports switching the section type,
but I don't believe <code>glibc</code> will read the output as it expects the <code>psABI</code> specified section (something <code>musl</code> can
handle though).</p>
<p>{{<figure_screenshot_one image="relr-brings-smaller-files-more-performance/Featured" caption="34 wasted bytes with GLIBC_ABI_DT_RELR">}}</p>
<h2 id="the-cost-of-adding-glibc_abi_dt_relr"><a class="toclink" href="../../2022/04/05/relr-brings-smaller-files-more-performance/#the-cost-of-adding-glibc_abi_dt_relr">The Cost of Adding GLIBC_ABI_DT_RELR</a></h2>
<p>A quick check of two equivalent builds (one adding the <code>GLIBC_ABI_DT_RELR</code> version dependency and one not), there was an
increase of 34 bytes to the file's sections (18 bytes to <code>.dynstr</code> and 16 bytes to <code>.gnu.version_r</code>). It also means
having to validate that the <code>GLIBC_ABI_DT_RELR</code> version is present in the <code>libc</code> and that the file using <code>RELR</code> includes
this version dependency. This may not sound like much but it is completely unnecessary! Note that the testing provided
in this blog post is without <code>GLIBC_ABI_DT_RELR</code>.</p>
<p>Regardless of what eventuates, these negatives won't ship in Serpent OS. This will allow for us to support files that
include the version dependency (when appimage and other distros catch up) as it will still exist in <code>libc</code>, but we won't
have the version check in files, nor will <code>glibc</code> check that the version exists before loading for packages built by
<code>boulder</code>.</p>
    <nav class="md-post__action">
      <a href="../../2022/04/05/relr-brings-smaller-files-more-performance/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/19542864" alt="Peter O'Connor">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2022-02-11 20:45:12+11:00">Friday, February 11, 2022</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/news/" class="md-meta__link">news</a></li>
        
        
          
          <li class="md-meta__item">
            
              11 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="making-deltas-great-again-part-1"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/">Making Deltas Great Again! (Part 1)</a></h2>
<p>In <a href="/blog/2021/03/16/optimising-package-distribution">Optimising Package Distribution</a> we discussed some early
findings for implementing binary deltas in Serpent OS. While discussing the implementation we have found the
requirements to be suboptimal for what we were after. We provide a fresh look at the issue and what we can do to make it
useful in almost all situations without the drawbacks.</p>
<!--more-->

<h2 id="deltas-have-a-bad-reputation"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/#deltas-have-a-bad-reputation">Deltas Have a Bad Reputation</a></h2>
<p>I remember back in the early 2000s on Gentoo when someone set up a server to produce delta patches from source tarballs
to distribute to users with small data caps such as myself. When requesting the delta, the job would be added to the
queue (which occasionally could be minutes) and then created a small patch to download. This was so important at the
time to reduce the download size that the extra time was well worth it!</p>
<p>Today things are quite different. The case for deltas has reduced for users as internet speeds have increased. Shrinking
20MB off a package size may be a second reduction for some, but 10 seconds for others. The largest issue is that deltas
have typically pushed extra computational effort onto the users computer in compensation for the smaller size. With a
fast internet connection that cost is a real burden where deltas take longer to install than simply downloading the full
package.</p>
<h2 id="whats-so-bad-about-the-old-method"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/#whats-so-bad-about-the-old-method">What's so Bad About the Old Method?</a></h2>
<p>The previous idea of using the full payload for deltas was very efficient in terms of distribution, but required changes
in how <code>moss</code> handles packages to implement it. Having the previous payload available (and being fast) means storing the
old payloads on disk. This increases the storage requirements for the base system, although that can be reduced by
compressing the payloads to reduce disk usage (but increasing CPU usage at install time).</p>
<p>To make it work well, we needed the following requirements:
- Install all the files from a package and recreate the payload from the individual files. However, Smart System
  Management allows users to avoid installing unneeded locale files and we would not be able to recreate the full
  payload without them.
- Alternatively we can store the full payloads on disk. Then there becomes a tradeoff from doubling storage space or
  additional overhead from compressing the payloads to reduce it.
- Significant memory requirements to use a delta when a package is large.</p>
<p>In short we weren't happy with having to increase the disk storage requirements (potentially more than 2x) or the
increase in CPU time to create compressed payloads to minimize it. This was akin to the old delta model, of smaller
downloads but significantly slower updates.</p>
<h2 id="exploring-an-alternative-approach"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/#exploring-an-alternative-approach">Exploring an Alternative Approach</a></h2>
<p>Optimal compression generally benefits from combining multiple files into one archive than to compress each file
individually. With <code>zstd</code> deltas, since you read in a dictionary (the old file), you already have good candidates for
compression matching. The real question was simply whether creating a delta for each file was a viable method for delta
distribution (packaged into a single payload of course).</p>
<p>As the real benefit of deltas is reducing download size, the first thing to consider is the size impact. Using the same
package as the previous blog post (but with newer versions of <code>QtWebEngine</code> and <code>zstd</code>) we look at what happens when you
delta each file individually. Note that the package is quite unique in that the largest file is 76% of the total package
size and that delta creation time increased a lot for files larger than 15-20MB at maximum compression.</p>
<table>
<thead>
<tr>
<th></th>
<th>Full Tarball</th>
<th>Individual Files</th>
<th>Full Tarball --zstd=chainLog=30</th>
<th>Individual Files --zstd=chainLog=30</th>
</tr>
</thead>
<tbody>
<tr>
<td>Time to create</td>
<td>134.6s</td>
<td>137.6s</td>
<td>157.9s</td>
<td>150.9s</td>
</tr>
<tr>
<td>Size of delta</td>
<td>30.8MB</td>
<td>29.8MB</td>
<td>28.3MB</td>
<td>28.6MB</td>
</tr>
<tr>
<td>Peak Memory</td>
<td>1.77GB</td>
<td>1.64GB</td>
<td>4.77GB</td>
<td>2.64GB</td>
</tr>
</tbody>
</table>
<p>Quite surprisingly, the delta sizes were very close! Most surprising was that without increasing the size of the
chainLog in <code>zstd</code>, the individual file approach actually resulted in smaller deltas! We can also see how much lower the
memory requirements were (and they would be much smaller when there isn't one large file in the package!). Our locale
and doc trimming of files will still work nicely, as we don't need to recreate the locale files that aren't installed
(as we still don't want them!).</p>
<p>The architecture of <code>moss</code> allows us to cache packages, where all cached packages are available for generating multiple
system roots including with our build tool <code>boulder</code> without any need for the original package file. Therefore any need
to retain old payloads or packages is no longer required or useful, eliminating the drawbacks of the previous delta
approach. The memory requirements are also reduced as the maximum memory requirement scales with the size of the largest
file, rather than the entire package (which is generally a lot bigger). There are many packages containing hundreds of
MBs of uncompressed data and a few into the GBs. But the largest file I could find installed locally was only 140MB, and
only a handful over 100MB. This smaller increase in memory requirements is a huge improvement and the small increase in
memory use to extract the deltas is likely to go unnoticed by users.</p>
<p>Well everything sounds pretty positive so far, there must be some drawback?</p>
<p>{{<figure_screenshot_one image="making-deltas-great-again-1/Featured" caption="">}}</p>
<h2 id="the-impact-on-package-cache-time"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/#the-impact-on-package-cache-time">The Impact on Package Cache Time</a></h2>
<p>As the testing method for this article is quite simplistic (<code>bash</code> loops and calls to <code>zstd</code> directly), the additional
overhead from creating deltas for individual files I estimated to be about 20ms compared to a proper solution. The main
difference from the old delta method is how we extract the payloads and recreate the files of the new package. Using the
full package you simply extract the content payload and split it into its corresponding files. The new approach requires
two steps, extracting the payload (we could in theory not compress it) and then applying patches to the original files
to recreate the new ones. Note that times differ slightly from the previous table due to minor variations between test
runs.</p>
<table>
<thead>
<tr>
<th></th>
<th>Normal Package</th>
<th>Individual Delta File Package</th>
</tr>
</thead>
<tbody>
<tr>
<td>Time to Delta Files</td>
<td>-</td>
<td>148.0s (137 files)</td>
</tr>
<tr>
<td>Time to Compress Payload</td>
<td>78.6s</td>
<td>4.0s</td>
</tr>
<tr>
<td>Size of Uncompressed Payload</td>
<td>165.8MB</td>
<td>28.9MB</td>
</tr>
<tr>
<td>Size of Compressed Payload</td>
<td>51.3MB</td>
<td>28.6MB</td>
</tr>
<tr>
<td>Instructions to Extract Payload</td>
<td>2,876.9m (349ms)</td>
<td>33.1m (34ms)</td>
</tr>
<tr>
<td>Instructions to Recreate Files</td>
<td>-</td>
<td>1,785.6m (452ms)</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Total instructions to Extract</td>
<td>2,876.9m (349ms)</td>
<td>1,818.7m (486ms)</td>
</tr>
</tbody>
</table>
<p>What's important to note is that is this reflects a worst case scenario for the delta approach, where all 137 files were
different between the old and new version of the package. Package updates where files remain unchanged allows us to omit
them from the delta package altogether! So the delta approach not only saves time downloading files, but also requires
fewer CPU instructions to apply the update. It's not quite a slam dunk though as reading the original file as a
dictionary results in an increase in elapsed time of extraction (though the extra time is likely much less than the time
saved downloading 20MB less!).</p>
<p>In Part 2 we will look at some ways we can tweak the approach to balance the needed resources for creating delta
packages and to reduce the time taken to apply them.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Note: This was intended to be a 2 part series as it contains a lot of information to digest.
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>However, Part 2 was committed and follows below.
</span></code></pre></div>
<p>There's more than one way to create a delta! This post follows on from the earlier analysis of creating some basic
delta packages. Where this approach, and the use of <code>zstd</code>, really thrives is that it gives us options in how to manage
the overhead, from creating the deltas to getting them installed locally. Next we explore some ideas of how we can
minimize the caching time of delta files.</p>
<h2 id="improving-delta-cache-time"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/#improving-delta-cache-time">Improving Delta Cache Time</a></h2>
<p>To get the best bang for your buck with deltas, it is essential to reduce the size of the larger files. My experience in
testing was that there wasn't a significant benefit from creating deltas for small files. In this example, we only
create delta files when they are larger than a specific size while including the full version of files that are under
the cutoff. This reduces the number of delta files created without impacting the overall package size by much.</p>
<table>
<thead>
<tr>
<th>Only Delta Files Greater Than</th>
<th>Greater than 10KB</th>
<th>Greater than 100KB</th>
<th>Greater than 500KB</th>
</tr>
</thead>
<tbody>
<tr>
<td>Time to Delta Files</td>
<td>146.1s (72 files)</td>
<td>146.3s (64 files)</td>
<td>139.4s (17 files)</td>
</tr>
<tr>
<td>Time to Compress Payload</td>
<td>3.9s</td>
<td>4.0s</td>
<td>8.3s</td>
</tr>
<tr>
<td>Size of Uncompressed Payload</td>
<td>28.9MB</td>
<td>29.3MB</td>
<td>42.4MB</td>
</tr>
<tr>
<td>Size of Compressed Payload</td>
<td>28.6MB</td>
<td>28.7MB</td>
<td>30.5MB</td>
</tr>
<tr>
<td>Instructions to Extract Payload</td>
<td>37.8m (36ms)</td>
<td>34.7m (29ms)</td>
<td>299.1m (66ms)</td>
</tr>
<tr>
<td>Instructions to Recreate Files</td>
<td>1,787.7m (411ms)</td>
<td>1,815.0m (406ms)</td>
<td>1,721.4m (368ms)</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Total instructions to Extract</td>
<td>1,825.5m (447ms)</td>
<td>1,849.7m (435ms)</td>
<td>2,020.5m (434ms)</td>
</tr>
</tbody>
</table>
<p>Here we see that by not creating deltas for files under 100KB, it barely impacts the size of the delta at all, while
reducing caching time by 50ms compared to creating a delta for every file (486ms from the previous blog post). It even
leads to up to a 36% reduction in CPU instructions to undertake caching through the delta than using the full package.
In terms of showing how effective this delta technique really is, I chose one of the worst examples and I would expect
that many deltas would be faster to cache when there's files that are exact matches between the old and new package. The
largest file alone took 300ms to apply the delta, where overheads tend to scale a lot when you start getting to larger
files.</p>
<p>There are also some steps we can take to make sure that caching a delta is almost always faster than the full package
(solving the only real drawback to users), only requiring Serpent OS resources to create these delta packages.</p>
<h2 id="creating-more-efficient-deltas"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/#creating-more-efficient-deltas">Creating More Efficient Deltas</a></h2>
<p>For this article, all the tests have been run with <code>zstd --ultra -22 --zstd=chainLog=30</code>...until now! The individual
file delta approach is more robust at lower compression levels to keep package size small while reducing how long they
take to create. Lets take a look at the difference while also ensuring <code>--long</code> is enabled. This testing combined with
the results above for only creating deltas for files larger than 10KB.</p>
<table>
<thead>
<tr>
<th>Individual Delta File Package</th>
<th>zstd -12</th>
<th>zstd -16</th>
<th>zstd -19</th>
<th>zstd -22</th>
</tr>
</thead>
<tbody>
<tr>
<td>Time to Delta Files</td>
<td>6.7s</td>
<td>113.9s</td>
<td>142.3s</td>
<td>148.3s</td>
</tr>
<tr>
<td>Time to Compress Payload</td>
<td>0.5s</td>
<td>3.2s</td>
<td>5.3s</td>
<td>4.0s</td>
</tr>
<tr>
<td>Size of Uncompressed Payload</td>
<td>41.1MB</td>
<td>30.6MB</td>
<td>28.9MB</td>
<td>28.9MB</td>
</tr>
<tr>
<td>Size of Compressed Payload</td>
<td>40.9MB</td>
<td>30.3MB</td>
<td>28.6MB</td>
<td>28.6MB</td>
</tr>
<tr>
<td>Instructions to Extract Payload</td>
<td>46.5m (35ms)</td>
<td>51.2m (28ms)</td>
<td>42.6m (33ms)</td>
<td>37.8m (36ms)</td>
</tr>
<tr>
<td>Instructions to Recreate Files</td>
<td>1,773.7m (382ms)</td>
<td>1,641.5m (385ms)</td>
<td>1,804.2m (416ms)</td>
<td>1,810.9m (430ms)</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>Total instructions to Extract</td>
<td>1,820.2m (417ms)</td>
<td>1,692.7m (413ms)</td>
<td>1,846.8m (449ms)</td>
<td>1,848.7m (466ms)</td>
</tr>
</tbody>
</table>
<p>Compression levels 16-19 look quite interesting where you start to reduce the time taken to apply the delta as well
and only seeing a small increase in size. For comparison, at <code>-19</code> it only took 9s to delta the remaining 39.8MB of
files when excluding the largest file (it was 15s at <code>-22</code>). While the time taken between 19 and 22 was almost the same,
at <code>-19</code> it took 27% fewer instructions to create the deltas than at <code>-22</code> (<code>-16</code> uses 64% fewer instructions than
<code>-22</code>). It will need testing across a broader range of packages to see the overall impact and to evaluate a sensible
default.</p>
<p>As a side effect of reducing the compression level, you also get another small decrease in the time to cache a package.
The best news of all is that these numbers are already out of date. Testing was performed last year with <code>zstd</code> 1.5.0,
where there have been notable speed improvements to both compression and decompression that have been included in newer
releases. Great news given how fast it is already! Here's a quick summary of how it all ties together.</p>
<h2 id="deltas-are-back"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/#deltas-are-back">Delta's Are Back!</a></h2>
<p>This blog series has put forward a lot of data that might be difficult to digest...but what does it mean for users of
Serpent OS? Here's a quick summary of the advantages of using this delta method on individual files when compared to
fetching the full packages:</p>
<ul>
<li>Package update sizes are greatly reduced to speed up fetching of package updates.</li>
<li><code>moss</code> architecture means that we have no need to leave packages on disk for later use, reducing the storage
  footprint. In fact, we could probably avoid writes (except for the extracted package of course!) by downloading
  packages to <code>tmpfs</code> where you have sufficient free memory.</li>
<li>Delta's can be used for updating packages for packaging <strong>and</strong> your installed system. There's no need for a full
  copy of the full original package for packaging. A great benefit when combined with the source repository.</li>
<li>Delta's are often overlooked due to being CPU intensive while most people have pretty decent internet speeds. This has
  a lot to do with how they are implemented.</li>
<li>With the current vision for Serpent OS deltas they will require fewer CPU instructions to use than full packages, but
  may slightly increase the time to cache some packages (but we are talking ms). But we haven't even considered the
  reduction in time taken to download the delta vs the full package which more than makes up the difference!</li>
<li>The memory requirements are reduced compared to the prior delta approach, especially if you factor in extracting the
  payload in memory (possibly using <code>tmpfs</code>) as part of installation.</li>
</ul>
<h2 id="getting-more-bang-for-your-buck"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/#getting-more-bang-for-your-buck">Getting More Bang for Your Buck</a></h2>
<p>There's still plenty more work to be done for implementing delta's in Serpent OS and they likely aren't that helpful
early on. To make delta packages sustainable and efficient over the long run, we can make them even better and reduce
some wastage. Here are some more ideas in how to make deltas less resource intensive and better for users:</p>
<ul>
<li>As we delta each file individually, we could easily use two or more threads to speed up caching time. Using this
  package as an example, two threads would reduce the caching time to 334ms, the time the largest file took to recreate
  plus the time to extract the payload. Now the delta takes less time and CPU to cache than the full package!</li>
<li><code>zstd</code> gives us options to tradeoff some increase in delta size to reduce the resources needed to create delta
  packages. This testing was performed with <code>--ultra -22 --zstd=chainLog=30</code> which is quite slow, but produces the
  smallest files. Even reducing the compression level to <code>-16 --long</code> didn't result in a large increase in delta size.</li>
<li>We always have the option to not create deltas for small packages to ease the burden, but in reality the biggest
  overhead is created from large files.</li>
<li>When creating deltas, you typically generate them for multiple prior releases. We can use smart criteria when to stop
  delta generation from earlier releases for instance if they save less than 10% total size or less than 100KB. A delta
  against an earlier release will almost always be larger than versus a more recent release.</li>
</ul>
<h2 id="even-better-than-these-numbers-suggest"><a class="toclink" href="../../2022/02/11/making-deltas-great-again-part-1/#even-better-than-these-numbers-suggest">Even Better than These Numbers Suggest</a></h2>
<p>While the numbers included have been nothing short of remarkable, they don't quite reflect how good this approach will
be. The results shown lack some of the key advantages of our delta approach such as excluding files that are unchanged
between the two packages. Other things that will show better results are:</p>
<ul>
<li>When package updates include minimal changes between versions (and smaller files), we would expect the average package
  to be much closer in elapsed time than indicated in these results.</li>
<li>A quick test using a delta of two package builds of the same source version resulted in a 13MB delta (rather than the
  28.6MB delta we had here). On top of that it took 62% fewer CPU instructions and less time (295ms) than the full
  package to extract (349ms) without resorting to multi-threading.</li>
<li>Delta creation of the average package will be quite fast where the largest files are &lt;30MB. In our example, one file
  is 76% of the package size (126MB) but can take nearly 95% of the total creation time!</li>
<li>We will be applying features to our packages that will reduce file sizes (such as the much smaller RELR relocations
  and identical code folding), making the approach even better, but that will be for a future blog post.</li>
</ul>
    <nav class="md-post__action">
      <a href="../../2022/02/11/making-deltas-great-again-part-1/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
        <article class="md-post md-post--excerpt">
  <header class="md-post__header">
    
      <nav class="md-post__authors md-typeset">
        
          <span class="md-author">
            <img src="https://avatars.githubusercontent.com/u/19542864" alt="Peter O'Connor">
          </span>
        
      </nav>
    
    <div class="md-post__meta md-meta">
      <ul class="md-meta__list">
        <li class="md-meta__item">
          <time datetime="2022-01-20 18:08:07+11:00">Thursday, January 20, 2022</time></li>
        
          <li class="md-meta__item">
            in
            
              <a href="../../category/news/" class="md-meta__link">news</a></li>
        
        
          
          <li class="md-meta__item">
            
              3 min read
            
          </li>
        
      </ul>
      
    </div>
  </header>
  <div class="md-post__content md-typeset">
    <h2 id="can-hardly-contain-myself-plus-a-bonus"><a class="toclink" href="../../2022/01/20/can-hardly-contain-myself-plus-a-bonus/">Can Hardly Contain Myself, Plus a Bonus</a></h2>
<p>One of the core steps for building a package is setting up a minimal environment with only the required (and stated)
dependencies. Currently we have been building our stones in an <code>systemd-nspawn</code> container, where the root contains every
package that's been built so far. This makes the environment extremely difficult to reproduce!</p>
<!--more-->

<p>Today we announce <code>moss-container</code>, a simple but flexible container creator that we can integrate for proper
containerized builds.</p>
<h2 id="versatile-for-many-use-cases"><a class="toclink" href="../../2022/01/20/can-hardly-contain-myself-plus-a-bonus/#versatile-for-many-use-cases">Versatile For Many Use Cases</a></h2>
<p>Containers have a multitude of uses for a Linux distro, but our immediate use case is for reproducible container builds
for <code>boulder</code>. However, we have plans to use <code>moss-container</code> for testing, validation and benchmarking purposes as well.
Therefore it's important to consider all workloads, so features like <code>fakeroot</code> and <code>networking</code> can be toggled on or
off depending on what features are needed.</p>
<p><code>moss-container</code> takes care of everything, the device nodes in the <code>/dev</code> tree, mounting directories as <code>tmpfs</code> so the
environment is left in a clean state, and mounting the <code>/sys</code> and <code>/proc</code> special file-systems. These are essential for
a fully functioning container where programs like <code>python</code> and even <code>clang</code> won't work without them. And best of all,
it's very fast so fits in well with the rest of our tooling!</p>
<p>The next step is integrating <code>moss-container</code> into <code>boulder</code>, so that builds become reproducible across machines, and
makes it much easier for users to run builds on their host machines.</p>
<h2 id="moss-now-understands-repositories"><a class="toclink" href="../../2022/01/20/can-hardly-contain-myself-plus-a-bonus/#moss-now-understands-repositories">moss Now Understands Repositories</a></h2>
<p>Previously (but not covered in the blogs) work was also done on <code>moss</code> so that it can understand and fetch <code>stone</code>
packages from an online repo. This ties in nicely with the <code>moss-container</code> work and is a requirement for finishing up a
proper build process for Serpent OS. We are now one step closer to having a full distribution cycle from building
packages and pushing those packages as system updates!</p>
<p><img alt="Container with functioning device nodes" src="../../../static/img/blog/can-hardly-contain-myself-plus-a-bonus/Featured.webp" /></p>
<h2 id="check-out-the-development"><a class="toclink" href="../../2022/01/20/can-hardly-contain-myself-plus-a-bonus/#check-out-the-development">Check Out The Development</a></h2>
<p>In case you've missed it, <code>ikey</code> has been streaming some of the development of the tooling on his
<a href="https://www.twitch.tv/ikeydoherty">Twitch channel</a>. DLang is not as commonly used as other languages, so check it out
to see the advantages it brings. Streams are typically announced on twitter, or give him a follow to see when he next
goes live!</p>
<h2 id="bonus-content-refresh"><a class="toclink" href="../../2022/01/20/can-hardly-contain-myself-plus-a-bonus/#bonus-content-refresh">Bonus Content Refresh</a></h2>
<p>This year we've had a considerable number of new visitors and interest in Serpent OS. Unfortunately the content on the
website had been a bit stale and untouched for some time. There was some confusion and misunderstanding over some of the
terms and content. Some of the common issues were:</p>
<ul>
<li>Subscriptions is a loaded term relating to software</li>
<li>Subscriptions only referred to a fraction of the smart features</li>
<li>Seemed targeted at advanced users with too many technical terms</li>
<li>Lack of understanding around what moss and boulder do</li>
<li>That features would add complexity when the tools were actually removing the complexity</li>
</ul>
<p>The good news is that a good chunk of it has been redone, including two new pages for our core tools <code>boulder</code> and
<code>moss</code>. <code>Subscriptions</code> has been renamed to <code>Smart System Management</code> to reflect its broader nature (which you can read
about <a href="/smart">here</a>).</p>
<p>Much of the content has also had a refresh or a rewrite, so if you've seen it before, it will likely be a lot easier to
digest now. But this isn't the final state of the content, as more features will need to be added and there's still a
few rough edges (and I like to rewrite things every once in awhile). Many ideas have been raised by our community in the
<a href="https://matrix.to/#/#serpentos:matrix.org">matrix channel</a>, so a shout-out to the good folks we have hanging out there.</p>
    <nav class="md-post__action">
      <a href="../../2022/01/20/can-hardly-contain-myself-plus-a-bonus/">
        Continue reading
      </a>
    </nav>
  </div>
</article>
      
      
        
          



<nav class="md-pagination">
  
</nav>
        
      
    </div>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../2023/" class="md-footer__link md-footer__link--prev" aria-label="Previous: 2023">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                2023
              </div>
            </div>
          </a>
        
        
          
          <a href="../2021/" class="md-footer__link md-footer__link--next" aria-label="Next: 2021">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                2021
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023-2024 Ikey Doherty, Serpent OS Developers

    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/serpent-os" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://fosstodon.org/@serpentos" target="_blank" rel="noopener me" title="fosstodon.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/Serpent_OS" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8l164.9-188.5L26.8 48h145.6l100.5 132.9L389.2 48zm-24.8 373.8h39.1L151.1 88h-42l255.3 333.8z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/channel/UCyGjpLXzRZdkD0Uc_uZJmaQ" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://matrix.to/#/#serpent-os-space:matrix.org" target="_blank" rel="noopener" title="matrix.to" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M208 352c114.9 0 208-78.8 208-176S322.9 0 208 0 0 78.8 0 176c0 38.6 14.7 74.3 39.6 103.4-3.5 9.4-8.7 17.7-14.2 24.7-4.8 6.2-9.7 11-13.3 14.3-1.8 1.6-3.3 2.9-4.3 3.7-.5.4-.9.7-1.1.8l-.2.2C1 327.2-1.4 334.4.8 340.9S9.1 352 16 352c21.8 0 43.8-5.6 62.1-12.5 9.2-3.5 17.8-7.4 25.3-11.4C134.1 343.3 169.8 352 208 352zm240-176c0 112.3-99.1 196.9-216.5 207 24.3 74.4 104.9 129 200.5 129 38.2 0 73.9-8.7 104.7-23.9 7.5 4 16 7.9 25.2 11.4 18.3 6.9 40.3 12.5 62.1 12.5 6.9 0 13.1-4.5 15.2-11.1 2.1-6.6-.2-13.8-5.8-17.9l-.2-.2c-.2-.2-.6-.4-1.1-.8-1-.8-2.5-2-4.3-3.7-3.6-3.3-8.5-8.1-13.3-14.3-5.5-7-10.7-15.4-14.2-24.7 24.9-29 39.6-64.7 39.6-103.4 0-92.8-84.9-168.9-192.6-175.5.4 5.1.6 10.3.6 15.5z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://forums.serpentos.com/" target="_blank" rel="noopener" title="forums.serpentos.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M144 0a80 80 0 1 1 0 160 80 80 0 1 1 0-160zm368 0a80 80 0 1 1 0 160 80 80 0 1 1 0-160zM0 298.7C0 239.8 47.8 192 106.7 192h42.7c15.9 0 31 3.5 44.6 9.7-1.3 7.2-1.9 14.7-1.9 22.3 0 38.2 16.8 72.5 43.3 96H21.3C9.6 320 0 310.4 0 298.7zM405.3 320h-.7c26.6-23.5 43.3-57.8 43.3-96 0-7.6-.7-15-1.9-22.3 13.6-6.3 28.7-9.7 44.6-9.7h42.7c58.9 0 106.7 47.8 106.7 106.7 0 11.8-9.6 21.3-21.3 21.3H405.3zM224 224a96 96 0 1 1 192 0 96 96 0 1 1-192 0zm-96 261.3c0-73.6 59.7-133.3 133.3-133.3h117.4c73.6 0 133.3 59.7 133.3 133.3 0 14.7-11.9 26.7-26.7 26.7H154.7c-14.7 0-26.7-11.9-26.7-26.7z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/sponsors/ikeycode" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M163.9 136.9c-29.4-29.8-29.4-78.2 0-108s77-29.8 106.4 0l17.7 18 17.7-18c29.4-29.8 77-29.8 106.4 0s29.4 78.2 0 108L310.5 240.1c-6.2 6.3-14.3 9.4-22.5 9.4s-16.3-3.1-22.5-9.4L163.9 136.9zm404.3 199.4c13.1 17.8 9.3 42.8-8.5 55.9l-126.6 93.3c-23.4 17.2-51.6 26.5-80.7 26.5H32c-17.7 0-32-14.3-32-32v-64c0-17.7 14.3-32 32-32h36.8l44.9-36c22.7-18.2 50.9-28 80-28H352c17.7 0 32 14.3 32 32s-14.3 32-32 32h-80c-8.8 0-16 7.2-16 16s7.2 16 16 16h120.6l119.7-88.2c17.8-13.1 42.8-9.3 55.9 8.5zM193.6 384h-.9.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="/feed_rss_created.xml" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M0 64c0-17.7 14.3-32 32-32 229.8 0 416 186.2 416 416 0 17.7-14.3 32-32 32s-32-14.3-32-32C384 253.6 226.4 96 32 96 14.3 96 0 81.7 0 64zm0 352a64 64 0 1 1 128 0 64 64 0 1 1-128 0zm32-256c159.1 0 288 128.9 288 288 0 17.7-14.3 32-32 32s-32-14.3-32-32c0-123.7-100.3-224-224-224-17.7 0-32-14.3-32-32s14.3-32 32-32z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.footer"], "search": "../../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>